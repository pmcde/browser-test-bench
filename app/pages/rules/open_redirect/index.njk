{% set navItem = {name: "Open Redirect"} %}
{% set listFiles = listFiles %}
{% set templatePath = "templates/layout.njk" if isGlobal else "templates/none.njk" %}
{% extends templatePath %}

{% block sectionTitle -%}
  <h1 class="h2">{{ navItem.name }}</h1>
{%- endblock %}

{% block content %}
  
  <p>CWE-601: URL Redirection to Untrusted Site ('Open Redirect')</p>

  {% for item in listFiles("app/pages/rules/open_redirect/!(index).+(html|njk|nunjucks)") %}
  {% import item.replace("app/","") as page %}
  <li>
      <a href="{{ item.replace("app/pages/","/").replace(".njk",".html") }}">      
      {{ page.navItem.name }}
      </a>
  </li>
  {% endfor %}

{% endblock %}